(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[703],{9403:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/protected/dashboard",function(){return s(2180)}])},2180:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSP:function(){return m},default:function(){return x}});var l=s(5893);s(8256);var r=s(7294),a=s(7066),n=s(3299),d=e=>{let{btcaddress:t}=e,[s,d]=(0,r.useState)(null),{data:c,status:o}=(0,n.useSession)();return(0,r.useEffect)(()=>{(async()=>{if(t&&c)try{let e=(await a.Z.get("https://api.bitcore.io/api/BTC/mainnet/address/".concat(t,"/balance"))).data.balance,s=parseFloat(e)/1e8;isNaN(s)?d(null):d(s)}catch(e){console.error("Error fetching balance:",e),d(null)}})()},[t,c]),(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,l.jsx)("h2",{className:"text-1xl font-bold mb-4",children:"Estimated Balance"}),(0,l.jsxs)("h1",{className:"text-1xl font-bold mb-2",children:["BTC Address: ",t||"Loading..."]}),null!==s?(0,l.jsxs)("p",{className:"mb-2",children:["Balance: ",s.toFixed(8)," BTC"]}):(0,l.jsx)("p",{children:"Loading balance..."})]})},c=s(1163),o=e=>{let{btcAddress:t}=e,s=(0,c.useRouter)();return(0,l.jsxs)("div",{className:"mt-8",children:[(0,l.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-4",onClick:()=>{t&&s.push({pathname:"/protected/deposit",query:{address:t}})},children:"Deposit"}),(0,l.jsx)("button",{className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",onClick:()=>{t&&s.push({pathname:"/protected/withdraw",query:{address:t}})},children:"Withdraw"})]})},i=e=>{let{userId:t,email:s}=e,{data:c}=(0,n.useSession)(),[i,u]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(()=>{{let e=localStorage.getItem("btcAddress_".concat(t));e&&u(e)}})()},[t]),(0,r.useEffect)(()=>{var e;let t=async e=>{try{console.log("Fetching BTC address for userId:",e);let{btcAddress:t}=(await a.Z.post("https://nodejsbtc.onrender.com/createbtcwallet",{userId:e})).data;t?(u(t),localStorage.setItem("btcAddress_".concat(e),t)):console.error("Endere\xe7o BTC n\xe3o foi retornado.")}catch(e){console.error("Erro ao buscar endere\xe7o BTC:",e)}};(null==c?void 0:null===(e=c.user)||void 0===e?void 0:e.id)&&t(c.user.id)},[c]),(0,l.jsxs)("div",{children:[(0,l.jsx)(d,{btcaddress:i}),(0,l.jsx)(o,{btcAddress:i})]})},u=e=>{let{userId:t,email:s}=e,{data:a,status:d}=(0,n.useSession)(),[c,o]=(0,r.useState)(null),[i,u]=(0,r.useState)(null),[m,x]=(0,r.useState)(!0),h=()=>{localStorage.removeItem("userId"),localStorage.removeItem("email"),o(null),u(null)};(0,r.useEffect)(()=>{{var e,t;let s=localStorage.getItem("userId"),l=localStorage.getItem("email");s&&l?(o(s),u(l)):(null==a?void 0:null===(e=a.user)||void 0===e?void 0:e.id)&&(null==a?void 0:null===(t=a.user)||void 0===t?void 0:t.email)?(localStorage.setItem("userId",a.user.id),localStorage.setItem("email",a.user.email),o(a.user.id),u(a.user.email)):h(),x(!1)}},[a]);let b=async()=>{await (0,n.signOut)({redirect:!0,callbackUrl:"/"}),h()};return m||"loading"===d?(0,l.jsx)("div",{children:"Loading..."}):(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Login Successful"}),(0,l.jsxs)("p",{className:"text-xl mb-4",children:["Welcome, ",(0,l.jsx)("br",{}),(0,l.jsx)("br",{}),"your user ID is: ",c&&(0,l.jsx)("span",{className:"text-red-500",children:c})," "]}),(0,l.jsx)("p",{className:"text-xl mb-4",children:i&&(0,l.jsxs)(l.Fragment,{children:["E-mail: ",(0,l.jsx)("span",{className:"text-red-500",children:i})]})}),(0,l.jsx)("button",{className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded mt-4",onClick:b,children:"Logout"})]})},m=!0,x=e=>{let{userId:t,email:s}=e;return(0,l.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-100 dark:bg-black",children:(0,l.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4",children:[(0,l.jsx)("div",{className:"bg-white p-8 rounded shadow-md w-96 h-96 text-center",children:(0,l.jsx)(u,{userId:t,email:s})}),(0,l.jsx)("div",{className:"bg-blue-200 p-8 rounded shadow-md w-96 h-96 text-center",children:(0,l.jsx)(i,{userId:t,email:s})})]})})}}},function(e){e.O(0,[143,888,774,179],function(){return e(e.s=9403)}),_N_E=e.O()}]);